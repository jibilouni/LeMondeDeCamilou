---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";

export async function getStaticPaths() {
    const blogEntries = await getCollection("blog");
    return blogEntries.map((entry) => ({
        params: { slug: entry.slug },
        props: { entry },
    }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout
    title={`${entry.data.title} - Le Monde de Camilou`}
    description={entry.data.description}
>
    <Header />

    <main class="pt-20">
        <!-- Article Header -->
        <section class="bg-rose-50 py-16 px-4">
            <div class="container mx-auto max-w-4xl text-center">
                <div class="flex items-center justify-center gap-4 mb-6">
                    <span
                        class="px-4 py-1 bg-white text-rose-500 rounded-full font-semibold text-sm shadow-sm"
                    >
                        {entry.data.category}
                    </span>
                    <span class="text-gray-500 text-sm">
                        {
                            entry.data.pubDate.toLocaleDateString("fr-FR", {
                                year: "numeric",
                                month: "long",
                                day: "numeric",
                            })
                        }
                    </span>
                </div>

                <h1
                    class="text-3xl md:text-5xl font-display font-bold text-gray-900 mb-6 leading-tight"
                >
                    {entry.data.title}
                </h1>

                <div
                    class="flex items-center justify-center gap-2 text-gray-600"
                >
                    <span class="font-medium">Par {entry.data.author}</span>
                </div>
            </div>
        </section>

        <!-- Article Content -->
        <article class="py-16 px-4">
            <div class="container mx-auto max-w-3xl prose prose-rose prose-lg">
                <Content />
            </div>
        </article>

        <!-- Share / CTA -->
        <section class="bg-white py-12 border-t border-gray-100">
            <div class="container mx-auto px-4 text-center">
                <p class="text-gray-600 mb-6 italic">
                    Cet article vous a plu ? Partagez-le ou venez en discuter
                    avec nous !
                </p>
                <a
                    href="/blog"
                    class="inline-flex items-center gap-2 text-rose-600 font-semibold hover:text-rose-700 transition-colors"
                >
                    ‚Üê Retour au blog
                </a>
            </div>
        </section>
    </main>

    <Footer />
</Layout>
